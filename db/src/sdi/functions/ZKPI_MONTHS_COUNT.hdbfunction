FUNCTION "MONTHS_COUNT" (PDV VARCHAR(255), ANNO_MESE_DA VARCHAR(6), ANNO_MESE_A VARCHAR(6)) 
RETURNS MONTHS INT 
LANGUAGE SQLSCRIPT 
AS 
BEGIN 

  SELECT COUNT(*) INTO MONTHS
  FROM DB_ZKPI_PDV_ANALYTICS_V
  WHERE
      PDV = :PDV
      AND ANNO_MESE >= :ANNO_MESE_DA
      AND ANNO_MESE <= :ANNO_MESE_A;

      IF MONTHS = 0 THEN
        MONTHS := 1;
    END IF;
            
END